# WeDraw ç”¨æˆ·ä¸­å¿ƒæœåŠ¡

ç”¨æˆ·ä¸­å¿ƒæœåŠ¡æ˜¯WeDrawå¹³å°çš„æ ¸å¿ƒæœåŠ¡ä¹‹ä¸€ï¼Œè´Ÿè´£ç»Ÿä¸€èº«ä»½è®¤è¯ã€æƒé™ç®¡ç†ã€ç”¨æˆ·ä¿¡æ¯ç®¡ç†ç­‰åŠŸèƒ½ã€‚

## åŠŸèƒ½ç‰¹æ€§

### ğŸ” èº«ä»½è®¤è¯
- ç”¨æˆ·æ³¨å†Œ/ç™»å½•
- JWTä»¤ç‰Œç®¡ç†
- åŒå› å­è®¤è¯(2FA)
- ç¤¾äº¤ç™»å½•é›†æˆ
- å¯†ç é‡ç½®

### ğŸ‘¤ ç”¨æˆ·ç®¡ç†
- ç”¨æˆ·ä¿¡æ¯ç®¡ç†
- å¤´åƒä¸Šä¼ 
- ä¸ªäººèµ„æ–™è®¾ç½®
- è´¦æˆ·å®‰å…¨è®¾ç½®
- éšç§è®¾ç½®

### ğŸ›¡ï¸ æƒé™æ§åˆ¶
- åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶(RBAC)
- ç»†ç²’åº¦æƒé™ç®¡ç†
- èµ„æºè®¿é—®æ§åˆ¶
- APIæƒé™éªŒè¯

### ğŸ“§ é€šçŸ¥æœåŠ¡
- é‚®ä»¶é€šçŸ¥
- çŸ­ä¿¡éªŒè¯
- ç³»ç»Ÿæ¶ˆæ¯
- é€šçŸ¥åå¥½è®¾ç½®

### ğŸ“Š ç®¡ç†åŠŸèƒ½
- ç”¨æˆ·ç®¡ç†åå°
- ç³»ç»Ÿç»Ÿè®¡
- æ“ä½œæ—¥å¿—
- å®‰å…¨å®¡è®¡

## æŠ€æœ¯æ ˆ

- **è¿è¡Œæ—¶**: Node.js 18+
- **æ¡†æ¶**: Express.js
- **æ•°æ®åº“**: MySQL 8.0
- **ç¼“å­˜**: Redis 7.0
- **ORM**: Sequelize
- **è®¤è¯**: JWT
- **éªŒè¯**: Joi
- **æ—¥å¿—**: Winston
- **æ–‡æ¡£**: Swagger

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Node.js >= 16.0.0
- MySQL >= 8.0
- Redis >= 6.0
- npm >= 8.0.0

### å®‰è£…ä¾èµ–

```bash
npm install
```

### ç¯å¢ƒé…ç½®

1. å¤åˆ¶ç¯å¢ƒé…ç½®æ–‡ä»¶ï¼š
```bash
cp .env.example .env
```

2. ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®æ•°æ®åº“ã€Redisç­‰è¿æ¥ä¿¡æ¯

### æ•°æ®åº“åˆå§‹åŒ–

1. åˆ›å»ºæ•°æ®åº“ï¼š
```bash
npm run db:create
```

2. è¿è¡Œè¿ç§»ï¼š
```bash
npm run migrate
```

3. å¡«å……ç§å­æ•°æ®ï¼š
```bash
npm run seed
```

### å¯åŠ¨æœåŠ¡

å¼€å‘æ¨¡å¼ï¼š
```bash
npm run dev
```

ç”Ÿäº§æ¨¡å¼ï¼š
```bash
npm start
```

## API æ–‡æ¡£

æœåŠ¡å¯åŠ¨åï¼Œè®¿é—® `http://localhost:3001/api-docs` æŸ¥çœ‹å®Œæ•´çš„APIæ–‡æ¡£ã€‚

### ä¸»è¦ç«¯ç‚¹

#### è®¤è¯ç›¸å…³
- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/logout` - ç”¨æˆ·ç™»å‡º
- `POST /api/v1/auth/refresh` - åˆ·æ–°ä»¤ç‰Œ
- `POST /api/v1/auth/forgot-password` - å¿˜è®°å¯†ç 
- `POST /api/v1/auth/reset-password` - é‡ç½®å¯†ç 

#### ç”¨æˆ·ç®¡ç†
- `GET /api/v1/users/profile` - è·å–ä¸ªäººä¿¡æ¯
- `PUT /api/v1/users/profile` - æ›´æ–°ä¸ªäººä¿¡æ¯
- `POST /api/v1/users/avatar` - ä¸Šä¼ å¤´åƒ
- `PUT /api/v1/users/password` - ä¿®æ”¹å¯†ç 
- `GET /api/v1/users/search` - æœç´¢ç”¨æˆ·

#### ç®¡ç†å‘˜åŠŸèƒ½
- `GET /api/v1/admin/users` - è·å–ç”¨æˆ·åˆ—è¡¨
- `POST /api/v1/admin/users` - åˆ›å»ºç”¨æˆ·
- `PUT /api/v1/admin/users/:id` - æ›´æ–°ç”¨æˆ·
- `DELETE /api/v1/admin/users/:id` - åˆ é™¤ç”¨æˆ·
- `GET /api/v1/admin/stats` - è·å–ç»Ÿè®¡ä¿¡æ¯

## éƒ¨ç½²

### Docker éƒ¨ç½²

1. æ„å»ºé•œåƒï¼š
```bash
docker build -t wedraw-user-center .
```

2. ä½¿ç”¨ Docker Composeï¼š
```bash
docker-compose up -d
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

1. è®¾ç½®ç¯å¢ƒå˜é‡
2. å®‰è£…ä¾èµ–ï¼š`npm ci --only=production`
3. è¿è¡Œæ•°æ®åº“è¿ç§»ï¼š`npm run migrate`
4. å¯åŠ¨æœåŠ¡ï¼š`npm start`

## å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ config/          # é…ç½®æ–‡ä»¶
â”‚   â”œâ”€â”€ database.js   # æ•°æ®åº“é…ç½®
â”‚   â””â”€â”€ redis.js      # Redisé…ç½®
â”œâ”€â”€ controllers/      # æ§åˆ¶å™¨
â”œâ”€â”€ middleware/       # ä¸­é—´ä»¶
â”œâ”€â”€ models/          # æ•°æ®æ¨¡å‹
â”œâ”€â”€ routes/          # è·¯ç”±å®šä¹‰
â”œâ”€â”€ services/        # ä¸šåŠ¡æœåŠ¡
â”œâ”€â”€ utils/           # å·¥å…·å‡½æ•°
â”œâ”€â”€ migrations/      # æ•°æ®åº“è¿ç§»
â””â”€â”€ seeders/         # ç§å­æ•°æ®
```

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ ESLint è¿›è¡Œä»£ç æ£€æŸ¥
- éµå¾ª Airbnb JavaScript è§„èŒƒ
- ä½¿ç”¨ Prettier æ ¼å¼åŒ–ä»£ç 

### æµ‹è¯•

è¿è¡Œæµ‹è¯•ï¼š
```bash
npm test
```

ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Šï¼š
```bash
npm run test:coverage
```

### æ—¥å¿—

æ—¥å¿—æ–‡ä»¶ä½äº `logs/` ç›®å½•ï¼š
- `error.log` - é”™è¯¯æ—¥å¿—
- `combined.log` - ç»¼åˆæ—¥å¿—
- `access.log` - è®¿é—®æ—¥å¿—

## ç›‘æ§å’Œç»´æŠ¤

### å¥åº·æ£€æŸ¥

è®¿é—® `GET /health` ç«¯ç‚¹æ£€æŸ¥æœåŠ¡çŠ¶æ€ã€‚

### æ€§èƒ½ç›‘æ§

- ä½¿ç”¨ Winston è®°å½•è¯¦ç»†æ—¥å¿—
- Redis ç¼“å­˜æ€§èƒ½ç›‘æ§
- æ•°æ®åº“è¿æ¥æ± ç›‘æ§

### å®‰å…¨æªæ–½

- å¯†ç åŠ å¯†å­˜å‚¨
- JWTä»¤ç‰Œå®‰å…¨
- è¯·æ±‚é™æµ
- SQLæ³¨å…¥é˜²æŠ¤
- XSSé˜²æŠ¤
- CSRFé˜²æŠ¤

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ•°æ®åº“è¿æ¥å¤±è´¥**
   - æ£€æŸ¥æ•°æ®åº“æœåŠ¡æ˜¯å¦å¯åŠ¨
   - éªŒè¯è¿æ¥é…ç½®
   - æ£€æŸ¥ç½‘ç»œè¿æ¥

2. **Redisè¿æ¥å¤±è´¥**
   - æ£€æŸ¥RedisæœåŠ¡çŠ¶æ€
   - éªŒè¯è¿æ¥å‚æ•°
   - æ£€æŸ¥é˜²ç«å¢™è®¾ç½®

3. **JWTä»¤ç‰ŒéªŒè¯å¤±è´¥**
   - æ£€æŸ¥å¯†é’¥é…ç½®
   - éªŒè¯ä»¤ç‰Œæ ¼å¼
   - æ£€æŸ¥ä»¤ç‰Œè¿‡æœŸæ—¶é—´

### æ—¥å¿—åˆ†æ

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹æ—¥å¿—ï¼š
```bash
# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
tail -f logs/error.log

# æŸ¥çœ‹è®¿é—®æ—¥å¿—
tail -f logs/access.log

# æœç´¢ç‰¹å®šé”™è¯¯
grep "ERROR" logs/combined.log
```

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. æäº¤æ›´æ”¹
4. æ¨é€åˆ°åˆ†æ”¯
5. åˆ›å»º Pull Request

## è®¸å¯è¯

MIT License

## è”ç³»æ–¹å¼

- é¡¹ç›®åœ°å€: https://github.com/wedraw/backend
- é—®é¢˜åé¦ˆ: https://github.com/wedraw/backend/issues
- é‚®ç®±: dev@wedraw.com