# WeDraw 企业微信服务环境配置

# 服务配置
NODE_ENV=development
PORT=3002
HOST=0.0.0.0
SERVICE_NAME=wedraw-wework-service

# 数据库配置
DB_HOST=localhost
DB_PORT=3306
DB_NAME=wedraw_wework
DB_USER=wedraw_wework
DB_PASSWORD=wedraw_wework_123
DB_DIALECT=mysql
DB_TIMEZONE=+08:00
DB_LOGGING=false

# Redis 配置
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=2
REDIS_KEY_PREFIX=wework:

# JWT 配置
JWT_SECRET=your-super-secret-jwt-key-for-wework-service
JWT_EXPIRES_IN=24h
JWT_REFRESH_SECRET=your-super-secret-refresh-key-for-wework
JWT_REFRESH_EXPIRES_IN=7d

# 企业微信配置
WEWORK_CORP_ID=your-corp-id
WEWORK_CORP_SECRET=your-corp-secret
WEWORK_AGENT_ID=your-agent-id
WEWORK_AGENT_SECRET=your-agent-secret
WEWORK_CONTACT_SECRET=your-contact-secret
WEWORK_CALLBACK_TOKEN=your-callback-token
WEWORK_CALLBACK_AES_KEY=your-callback-aes-key

# 企业微信API配置
WEWORK_API_BASE_URL=https://qyapi.weixin.qq.com
WEWORK_ACCESS_TOKEN_CACHE_KEY=wework:access_token
WEWORK_ACCESS_TOKEN_EXPIRES=7200
WEWORK_JSAPI_TICKET_CACHE_KEY=wework:jsapi_ticket
WEWORK_JSAPI_TICKET_EXPIRES=7200

# 文件上传配置
UPLOAD_DIR=uploads
UPLOAD_MAX_SIZE=10485760
UPLOAD_ALLOWED_TYPES=image/jpeg,image/png,image/gif,image/webp,application/pdf,text/plain

# 限流配置
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX=1000
RATE_LIMIT_MESSAGE=Too many requests from this IP

# 安全配置
BCRYPT_ROUNDS=12
SESSION_SECRET=your-session-secret-key
CSRF_SECRET=your-csrf-secret-key

# CORS 配置
CORS_ORIGIN=*
CORS_CREDENTIALS=true

# 日志配置
LOG_LEVEL=info
LOG_FILE=logs/wework-service.log
LOG_MAX_SIZE=20m
LOG_MAX_FILES=14d
LOG_DATE_PATTERN=YYYY-MM-DD

# 缓存配置
CACHE_TTL=3600
CACHE_MAX_KEYS=10000
CACHE_CHECK_PERIOD=600

# 消息队列配置
MQ_HOST=localhost
MQ_PORT=5672
MQ_USER=guest
MQ_PASSWORD=guest
MQ_VHOST=/
MQ_EXCHANGE=wework.exchange
MQ_QUEUE=wework.queue

# WebSocket 配置
WS_CORS_ORIGIN=*
WS_PING_TIMEOUT=60000
WS_PING_INTERVAL=25000

# 监控配置
MONITOR_ENABLED=true
MONITOR_INTERVAL=30000
HEALTH_CHECK_TIMEOUT=5000

# 外部服务配置
USER_CENTER_URL=http://localhost:3001
API_GATEWAY_URL=http://localhost:3000
MESSAGE_CENTER_URL=http://localhost:3006

# 定时任务配置
CRON_SYNC_CONTACTS=0 */6 * * *
CRON_SYNC_DEPARTMENTS=0 */12 * * *
CRON_CLEAN_LOGS=0 2 * * *
CRON_BACKUP_DATA=0 3 * * 0

# 开发配置
DEBUG=wework:*
NODEMON_IGNORE=logs/*,uploads/*,coverage/*

# 生产配置
PM2_INSTANCES=max
PM2_MAX_MEMORY_RESTART=1G
PM2_ERROR_FILE=logs/pm2-error.log
PM2_OUT_FILE=logs/pm2-out.log
PM2_LOG_FILE=logs/pm2.log

# 企业微信机器人配置
BOT_WEBHOOK_TIMEOUT=30000
BOT_MAX_MESSAGE_LENGTH=4096
BOT_RATE_LIMIT=20
BOT_RATE_LIMIT_WINDOW=60000

# 群聊配置
GROUP_MAX_MEMBERS=500
GROUP_MESSAGE_HISTORY_DAYS=30
GROUP_FILE_MAX_SIZE=100MB

# 通讯录同步配置
CONTACT_SYNC_BATCH_SIZE=100
CONTACT_SYNC_INTERVAL=3600000
CONTACT_CACHE_TTL=1800

# 消息推送配置
MESSAGE_PUSH_TIMEOUT=10000
MESSAGE_RETRY_TIMES=3
MESSAGE_RETRY_DELAY=1000

# 文件存储配置
FILE_STORAGE_TYPE=local
FILE_STORAGE_PATH=uploads/wework
FILE_URL_PREFIX=http://localhost:3002/uploads

# 数据备份配置
BACKUP_ENABLED=true
BACKUP_PATH=backups
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESS=true